<% posts.each do |post| %>
  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title">投稿者: <%= link_to post.user.name, user_path(post.user) %></h5>
      <p class="card-text"><%= post.content %></p>
      
      <%= link_to '詳細を見る', post_path(post), class: 'btn btn-sm btn-info me-2' %>
      
      <%# 🌟 編集・削除ボタンの表示制限 (要件 10) 🌟 %>
      <% if current_user == post.user %>
        <%= link_to '編集', edit_post_path(post), class: 'btn btn-sm btn-warning me-2' %>
        <%= link_to '削除', post_path(post), 
                    method: :delete, 
                    data: { confirm: '本当に削除してもよろしいですか？' }, # 削除前の確認 (要件 9)
                    class: 'btn btn-sm btn-danger' %>
      <% end %>
      <p>この投稿へのいいね数: <%= post.likes.count %></p>

      <% if user_signed_in? %> 
        <% if current_user.already_liked?(post) %>
          <%= link_to '❤️ いいね！解除', post_likes_path(post), method: :delete, class: 'btn btn-secondary' %>
        <% else %>
          <%= link_to '♡ いいね！', post_likes_path(post), method: :post, class: 'btn btn-danger' %>
        <% end %>
      <% end %>
    </div>
  </div>
<% end %>